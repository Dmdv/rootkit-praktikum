Rootkit Programming - Exercise 8

You should have recieved the following files (in the archive ex8.tar):
 * README
 * Makefile
 * mod.c

We hook sys_read by changing the function pointer in the system call table
to a function hooked_read accepting the same parameters as the original
read function.

We find the system table in memory by traversing a certain memory section.
We start at &lock_kernel (which is in memory before the system call table)
and go (in steps of 2 bytes) until we find a memory location p where 
p[__NR_close]==sys_close. This memory location is guessed to be the address 
of the system call table.

We considered using try_module_get and put_module to avoid "unallowed unloading"
of our module. However, we ran into some troubles using these, while without 
them, everything seemed just fine. So, we abandoned it.